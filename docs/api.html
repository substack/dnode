<h1>DNode API (0.3.6)</h1>

<h1>Module : <code>dnode</code></h1>

<p>the DNode prototype is the main part of this module. it is used wrap an object in the DNode protocol.
the DNode prototype is exported as <code>modules.exports = DNode</code> and as <code>modules.exports.DNode = DNode</code> so it may be invoked as both:</p>

<p>DNode = require('dnode')</p>

<p>or</p>

<p>DNode = require('dnode').DNode</p>

<h2>Methods</h2>

<ul>
<li>DNode
<ul>
<li>listen </li>
<li>connect</li>
<li>end</li>
<li>close</li>
<li>withStream</li>
<li>on</li>
</ul></li>
<li>sync</li>
<li>expose</li>
<li>listen </li>
<li>connect</li>
</ul>

<h2>DNode (extends EventEmitter)</h2>

<h3>method: <code>DNode(wrapper)</code></h3>

<p>wrap and object in <code>DNode</code> so that it can be used as a server or as a client (see <code>DNode.listen</code> and <code>DNode.connect</code> respectively)</p>

<p><code>wrapper</code> can be either an object, or a constructor for an object.</p>

<p>if <code>wrapper</code> is a constructor, then a new instance with be created each time a connection is made.
the constructor is called with the arguments <code>new wrapper(remote,connection)</code> where remote a representation of the wrapper from 
the connecting <code>DNode</code>, and <code>connection</code> is the connection object (see <code>dnode/lib/conn.js</code>)</p>

<p>as of version 0.3.6 this is the only way to get a hold of a connection object.</p>

<p>if <code>wrapper</code> is a object, the same object will be used for every connection.</p>

<h3>method: <code>.listen(port,options,server)</code></h3>

<p>create a server from a <code>DNode</code> instance. arguments may be provided in any order, and are parsed by their type. <code>port</code> is the only non-optional argument.</p>

<p>if server is an instance of <code>http.Server</code>, <code>net.Server</code> or <code>io.Listener</code> it will be used to host the DNode server. (I think, I havn't actually tried this yet, and the only example I've seen in <code>dnode/test/stream.js</code> - Dominic)</p>

<p>options is a hash of each argument, but they are named. if port is in args it does not need to be passed directly to listen.</p>

<h3>method: <code>.connect(port,options,server,onConnect)</code></h3>

<p>connects to a DNode server on the given port. 
the arguments have the same behaviour as listen except there is a callback for when the connection to the server is returned. which will be called like this: <code>onConnect(remote)</code> where <code>remote</code> is a repesentation of the wrapped instance used to start the server.</p>

<h3>method: <code>.end</code></h3>

<p>end all connections from a server. 
attempting to .end() a client will throw an error.</p>

<h3>method: <code>.close</code></h3>

<p>synonym for end.</p>

<h3>method: <code>.withStream(stream,opts,block)</code></h3>

<p>I don't fully understand this one yet, can you help, James?
-Dominic</p>

<h3>method: <code>.on(eventname, listener)</code></h3>

<p>on method from <code>EventEmitter</code></p>

<p>DNode generates the following events
   + 'ready' generated by a server or client once it is able to recieve/make a connection.</p>

<p>I vote for including a few more events, to make the interface more flexible - Dominic.</p>

<h3>method <code>sync(function)</code></h3>

<p>wraps a sync method in a another function which callsback with the return value:
      function ten (){ return 10 };</p>

<pre><code>  tenAsync = DNode.sync(ten)

  tenAsync(function(r) { 
     assert.equal(r,10); 
  });
</code></pre>

<h3>method: <code>connect(port,...)</code></h3>

<p>calls <code>DNode().connect(port,...)</code> i.e. creates empty DNode instance and connects to server on given port.</p>

<h3>method: <code>listen(port,...)</code></h3>

<p>calls <code>DNode().listen(port,...)</code> i.e. creates an empty DNode instance starts as a server listening on <code>port</code></p>

<h3>method <code>expose(obj,method)</code></h3>

<p>tell DNode to show an inherited method across the connection.
DNode does not do this by default, and must be told to do so explicitly. this is a feature.</p>

<p>usuage:</p>

<pre><code>  DNode(function Class1 (client,conn){
     DNode.expose(this,'methodName')
     //etc
  }).listen(6060)
</code></pre>
